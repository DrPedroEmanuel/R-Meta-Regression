required_packages <- c("readxl", "dplyr", "tidyr")

for (package in required_packages){
  if (!requireNamespace(package, quietly = TRUE)){
    install.packages(package)
  }
  if (!(package %in% loadedNamespaces())) {
    library("package")
  }
}


read_sheets_in_xlsx <- function(xlsx_file){
  sheets <- excel_sheets(xlsx_file)
  dataframes <- c()
  for(sheet in sheets){
    dataframes <- create_dataframe_from_sheet(xlsx_file, sheet)
  }
  names(dataframes) <- sheets
  print("Sheets extracted")
  return(dataframes)
}

create_dataframe_from_sheet <- function(xlsx_file_, sheet){
  dataframe <- read_excel(xlsx_file_, sheet = sheet)
  dataframe$outcome <- sheet
  return(dataframe)
}